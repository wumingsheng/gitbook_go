# 03 | 库源码文件

![](https://static001.geekbang.org/resource/image/61/f6/611ca0a627d9a2dc8441d05083307cf6.jpg)


库源码文件是不能被直接运行的源码文件，它仅用于存放程序实体，这些程序实体可以被其他代码使用（只要遵从 Go 语言规范的话）。

这里的“其他代码”可以与被使用的程序实体在同一个源码文件内，也可以在其他源码文件，甚至其他代码包中。


那么程序实体是什么呢？在 Go 语言中，程序实体是变量、常量、函数、结构体和接口的统称。

在同一个目录下的源码文件都需要被声明为属于同一个代码包。

## 什么是实现？

- 空接口可以代表所有类型，包括基本数据类型和所有的引用类型
- 接口可以定义方法
- 函数可以绑定在结构体上
- 如果一个结构体上绑定了接口的所有方法，可以认为这个结构体实现了这个接口


```go
type interfaceName interface {
    methodName1() [returnType]
    methodName2() [returnType]
    ...
    methodNamen() [returnType]
}
```

## 什么是继承？

结构体中定义了另一个结构体作为它的一个成员，可以认为这个结构体就实现了另一个结构体

```go
type TestController struct {
	beego.Controller
}
```

## 代码包声明的基本规则

1. 第一条规则，同目录下的源码文件的代码包声明语句要一致。也就是说，它们要同属于一个代码包。这对于所有源码文件都是适用的。

	如果目录中有命令源码文件，那么其他种类的源码文件也应该声明属于main包。这也是我们能够成功构建和运行它们的前提。

2. 第二条规则，源码文件声明的代码包的名称可以与其所在的目录的名称不同。在针对代码包进行构建时，生成的结果文件的主名称与其父目录的名称一致。

	对于命令源码文件而言，构建生成的可执行文件的主名称会与其父目录的名称相同，这在我前面的回答中也验证过了。



### 1. 代码包的导入路径总会与其所在目录的相对路径一致吗？

代码包所在的目录路径不一定非要和声明的`package`一致，为了不让该代码包的使用者产生困惑，我们总是应该让声明的包名与其父目录的名称一致。

使用的时候，导入的是目录路径，使用的限定符是被声明的`package`


###　2. 什么样的程序实体才可以被当前包外的代码引用？



超级简单，名称的首字母为大写的程序实体才可以被当前包外的代码引用，否则它就只能被当前包内的其他代码引用。

通过名称，Go 语言自然地把程序实体的访问权限划分为了包级私有的和公开的。对于包级私有的程序实体，即使你导入了它所在的代码包也无法引用到它。


### 3. 对于程序实体，还有其他的访问权限规则吗？

答案是肯定的。在 Go 1.5 及后续版本中，我们可以通过创建internal代码包让一些程序实体仅仅能被当前模块中的其他代码引用。这被称为 Go 程序实体的第三种访问权限：模块级私有。

具体规则是，internal代码包中声明的公开程序实体仅能被该代码包的直接父包及其子包中的代码引用。当然，引用前需要先导入这个internal包。对于其他代码包，导入该internal包都是非法的，无法通过编译。




